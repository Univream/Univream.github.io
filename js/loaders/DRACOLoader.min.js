"use strict";THREE.DRACOLoader=function(e){this.timeLoaded=0,this.manager=e||THREE.DefaultLoadingManager,this.materials=null,this.verbosity=0,this.attributeOptions={},this.drawMode=THREE.TrianglesDrawMode,this.nativeAttributeMap={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"}},THREE.DRACOLoader.prototype={constructor:THREE.DRACOLoader,load:function(e,t,r,o){var i=this,n=new THREE.FileLoader(i.manager);n.setPath(this.path),n.setResponseType("arraybuffer"),void 0!==this.crossOrigin&&(n.crossOrigin=this.crossOrigin),n.load(e,function(e){i.decodeDracoFile(e,t)},r,o)},setPath:function(e){this.path=e},setCrossOrigin:function(e){this.crossOrigin=e},setVerbosity:function(e){this.verbosity=e},setDrawMode:function(e){this.drawMode=e},setSkipDequantization:function(e,t){var r=!0;void 0!==t&&(r=t),this.getAttributeOptions(e).skipDequantization=r},decodeDracoFile:function(e,t,r,o){var i=this;THREE.DRACOLoader.getDecoderModule().then(function(n){i.decodeDracoFileInternal(e,n.decoder,t,r||{},o||{})})},decodeDracoFileInternal:function(e,t,r,o,i){var n=new t.DecoderBuffer;n.Init(new Int8Array(e),e.byteLength);var a=new t.Decoder,d=a.GetEncodedGeometryType(n);if(d==t.TRIANGULAR_MESH)this.verbosity>0&&console.log("Loaded a mesh.");else{if(d!=t.POINT_CLOUD){var s="THREE.DRACOLoader: Unknown geometry type.";throw console.error(s),new Error(s)}this.verbosity>0&&console.log("Loaded a point cloud.")}r(this.convertDracoGeometryTo3JS(t,a,d,n,o,i))},addAttributeToGeometry:function(e,t,r,o,i,n,a,d){if(0===n.ptr){var s="THREE.DRACOLoader: No attribute "+o;throw console.error(s),new Error(s)}var u,c,l=n.num_components(),A=r.num_points()*l;switch(i){case Float32Array:u=new e.DracoFloat32Array,t.GetAttributeFloatForAllPoints(r,n,u),d[o]=new Float32Array(A),c=THREE.Float32BufferAttribute;break;case Int8Array:u=new e.DracoInt8Array,t.GetAttributeInt8ForAllPoints(r,n,u),d[o]=new Int8Array(A),c=THREE.Int8BufferAttribute;break;case Int16Array:u=new e.DracoInt16Array,t.GetAttributeInt16ForAllPoints(r,n,u),d[o]=new Int16Array(A),c=THREE.Int16BufferAttribute;break;case Int32Array:u=new e.DracoInt32Array,t.GetAttributeInt32ForAllPoints(r,n,u),d[o]=new Int32Array(A),c=THREE.Int32BufferAttribute;break;case Uint8Array:u=new e.DracoUInt8Array,t.GetAttributeUInt8ForAllPoints(r,n,u),d[o]=new Uint8Array(A),c=THREE.Uint8BufferAttribute;break;case Uint16Array:u=new e.DracoUInt16Array,t.GetAttributeUInt16ForAllPoints(r,n,u),d[o]=new Uint16Array(A),c=THREE.Uint16BufferAttribute;break;case Uint32Array:u=new e.DracoUInt32Array,t.GetAttributeUInt32ForAllPoints(r,n,u),d[o]=new Uint32Array(A),c=THREE.Uint32BufferAttribute;break;default:s="THREE.DRACOLoader: Unexpected attribute type.";throw console.error(s),new Error(s)}for(var E=0;E<A;E++)d[o][E]=u.GetValue(E);a.addAttribute(o,new c(d[o],l)),e.destroy(u)},convertDracoGeometryTo3JS:function(e,t,r,o,i,n){var a,d;!0===this.getAttributeOptions("position").skipDequantization&&t.SkipAttributeTransform(e.POSITION);const s=performance.now();if(r===e.TRIANGULAR_MESH?(a=new e.Mesh,d=t.DecodeBufferToMesh(o,a)):(a=new e.PointCloud,d=t.DecodeBufferToPointCloud(o,a)),!d.ok()||0==a.ptr){var u="THREE.DRACOLoader: Decoding failed: ";throw u+=d.error_msg(),console.error(u),e.destroy(t),e.destroy(a),new Error(u)}var c,l=performance.now();e.destroy(o),r==e.TRIANGULAR_MESH?(c=a.num_faces(),this.verbosity>0&&console.log("Number of faces loaded: "+c.toString())):c=0;var A=a.num_points(),E=a.num_attributes();this.verbosity>0&&(console.log("Number of points loaded: "+A.toString()),console.log("Number of attributes loaded: "+E.toString()));var f=t.GetAttributeId(a,e.POSITION);if(-1==f){u="THREE.DRACOLoader: No position attribute found.";throw console.error(u),e.destroy(t),e.destroy(a),new Error(u)}var R=t.GetAttribute(a,f),y={},b=new THREE.BufferGeometry;for(var D in this.nativeAttributeMap)if(void 0===i[D]){var T=t.GetAttributeId(a,e[this.nativeAttributeMap[D]]);if(-1!==T){this.verbosity>0&&console.log("Loaded "+D+" attribute.");var m=t.GetAttribute(a,T);this.addAttributeToGeometry(e,t,a,D,Float32Array,m,b,y)}}for(var D in i){var p=n[D]||Float32Array,h=i[D];m=t.GetAttributeByUniqueId(a,h);this.addAttributeToGeometry(e,t,a,D,p,m,b,y)}if(r==e.TRIANGULAR_MESH)if(this.drawMode===THREE.TriangleStripDrawMode){var w=new e.DracoInt32Array;t.GetTriangleStripsFromMesh(a,w);y.indices=new Uint32Array(w.size());for(var O=0;O<w.size();++O)y.indices[O]=w.GetValue(O);e.destroy(w)}else{var v=3*c;y.indices=new Uint32Array(v);var H=new e.DracoInt32Array;for(O=0;O<c;++O){t.GetFaceFromMesh(a,O,H);var L=3*O;y.indices[L]=H.GetValue(0),y.indices[L+1]=H.GetValue(1),y.indices[L+2]=H.GetValue(2)}e.destroy(H)}b.drawMode=this.drawMode,r==e.TRIANGULAR_MESH&&b.setIndex(new(y.indices.length>65535?THREE.Uint32BufferAttribute:THREE.Uint16BufferAttribute)(y.indices,1));var C=new e.AttributeQuantizationTransform;if(C.InitFromAttribute(R)){b.attributes.position.isQuantized=!0,b.attributes.position.maxRange=C.range(),b.attributes.position.numQuantizationBits=C.quantization_bits(),b.attributes.position.minValues=new Float32Array(3);for(O=0;O<3;++O)b.attributes.position.minValues[O]=C.min_value(O)}return e.destroy(C),e.destroy(t),e.destroy(a),this.decode_time=l-s,this.import_time=performance.now()-l,this.verbosity>0&&(console.log("Decode time: "+this.decode_time),console.log("Import time: "+this.import_time)),b},isVersionSupported:function(e,t){THREE.DRACOLoader.getDecoderModule().then(function(r){t(r.decoder.isVersionSupported(e))})},getAttributeOptions:function(e){return void 0===this.attributeOptions[e]&&(this.attributeOptions[e]={}),this.attributeOptions[e]}},THREE.DRACOLoader.decoderPath="./",THREE.DRACOLoader.decoderConfig={},THREE.DRACOLoader.decoderModulePromise=null,THREE.DRACOLoader.setDecoderPath=function(e){THREE.DRACOLoader.decoderPath=e},THREE.DRACOLoader.setDecoderConfig=function(e){var t=THREE.DRACOLoader.decoderConfig.wasmBinary;THREE.DRACOLoader.decoderConfig=e||{},THREE.DRACOLoader.releaseDecoderModule(),t&&(THREE.DRACOLoader.decoderConfig.wasmBinary=t)},THREE.DRACOLoader.releaseDecoderModule=function(){THREE.DRACOLoader.decoderModulePromise=null},THREE.DRACOLoader.getDecoderModule=function(){var e=this,t=THREE.DRACOLoader.decoderPath,r=THREE.DRACOLoader.decoderConfig,o=THREE.DRACOLoader.decoderModulePromise;return o||("undefined"!=typeof DracoDecoderModule?o=Promise.resolve():"object"!=typeof WebAssembly||"js"===r.type?o=THREE.DRACOLoader._loadScript(t+"draco_decoder.js"):(r.wasmBinaryFile=t+"draco_decoder.wasm",o=THREE.DRACOLoader._loadScript(t+"draco_wasm_wrapper.js").then(function(){return THREE.DRACOLoader._loadArrayBuffer(r.wasmBinaryFile)}).then(function(e){r.wasmBinary=e})),o=o.then(function(){return new Promise(function(t){r.onModuleLoaded=function(r){e.timeLoaded=performance.now(),t({decoder:r})},DracoDecoderModule(r)})}),THREE.DRACOLoader.decoderModulePromise=o,o)},THREE.DRACOLoader._loadScript=function(e){var t=document.getElementById("decoder_script");null!==t&&t.parentNode.removeChild(t);var r=document.getElementsByTagName("head")[0],o=document.createElement("script");return o.id="decoder_script",o.type="text/javascript",o.src=e,new Promise(function(e){o.onload=e,r.appendChild(o)})},THREE.DRACOLoader._loadArrayBuffer=function(e){var t=new THREE.FileLoader;return t.setResponseType("arraybuffer"),new Promise(function(r,o){t.load(e,r,void 0,o)})};